/*! elasto.js - v0.1.0 - 2015-12-16 - [object Object] */
(function(){function e(e){"use strict";var t={hideIncompleteRow:!1,trackActive:!0,trackAnimation:!0,minSize:150,move:null,select:null,click:null,enter:null,keyEventsEnabled:!0,customAttributes:{},objectKeys:{image:"img",title:"title",text:"text"}},n=e.Elasto=function(e,i,r){var o,l,a,s,c,u,f,d,h,m,p=this,v=!1,g=function(){l=document.getElementById(e),l.classList.add("elasto-container"),o=i?i:[],y(),w(),window.addEventListener("keydown",x),window.addEventListener("keyup",q),window.addEventListener("resize",L),v=!0},y=function(){r=r||{},m=m||{};for(var e in t)t.hasOwnProperty(e)&&r.hasOwnProperty(e)?m[e]=r[e]:t.hasOwnProperty(e)&&(m[e]=t[e])},w=function(){for(;l.firstChild;)l.removeChild(l.firstChild);s=0,k(),m.hideIncompleteRow&&!v&&o.length>c&&c>0&&(o.splice(o.length-c,c),s=0,k()),f=null;for(var e=0;o.length>e;e++)E(e);o.length&&A(1)},E=function(e){var t=b();t.style.width=u+"%",t.setAttribute("data-id",e+1);for(var n in m.customAttributes)(function(n){if(m.customAttributes.hasOwnProperty(n)){var i=m.customAttributes[n].replace(/\{\{([^{}]+)\}\}/g,function(t){var n=t.replace(/\{/g,"").replace(/\}/g,"");return o[e].hasOwnProperty(n)?o[e][n]:t});t.setAttribute(n,i)}})(n);o[e].hasOwnProperty(m.objectKeys.image)&&o[e][m.objectKeys.image]&&(t.getElementsByClassName("elasto-square-bg")[0].style.backgroundImage="url("+o[e][m.objectKeys.image]+")"),o[e].hasOwnProperty(m.objectKeys.title)&&(t.getElementsByClassName("elasto-square-title")[0].innerHTML=o[e][m.objectKeys.title],t.getElementsByClassName("elasto-square-title")[0].title=o[e][m.objectKeys.title]),o[e].hasOwnProperty(m.objectKeys.text)&&(t.getElementsByClassName("elasto-square-text")[0].innerHTML=o[e][m.objectKeys.text]),t.addEventListener("click",j),o[e].elem=t,l.appendChild(t),f||(f=Math.floor(t.clientWidth)),t.style.height=f+"px"},b=function(){var e=document.createElement("div");e.classList.add("elasto-square");var t=document.createElement("div");t.classList.add("elasto-square-bg");var n=document.createElement("div");n.classList.add("elasto-square-wrap");var i=document.createElement("div");i.classList.add("elasto-square-title");var r=document.createElement("div");return r.classList.add("elasto-square-text"),e.appendChild(t),e.appendChild(n),n.appendChild(i),n.appendChild(r),e.cloneNode(!0)},k=function(){var e=Math.floor(l.clientWidth),t=Math.floor(e/m.minSize);t=0===t?1:t,t!==s&&(s=t,a=Math.floor(o.length/s),c=o.length%s,u=100/s)},L=function(){h&&clearTimeout(h),h=setTimeout(I,50)},I=function(){if(o.length){var e=u.valueOf();if(k(),e!==u){o[0].elem.style.width=u+"%",f=Math.floor(o[0].elem.clientWidth);for(var t=0;o.length>t;t++)o[t].elem.style.width=u+"%",o[t].elem.style.height=f+"px"}else{f=Math.floor(o[0].elem.clientWidth);for(var n=0;o.length>n;n++)o[n].elem.style.height=f+"px"}}},A=function(e){for(var t=l.getElementsByClassName("active"),n=0;t.length>n;n++)t[n].classList.remove("active");d=e,o[e-1].elem.classList.add("active")},T=function(){return o[d-1]},_=function(){if(o.length){for(var e,t=l;t&&(e=window.getComputedStyle(t).getPropertyValue("overflow"),"visible"===e);)t=t.parentElement;var n,i,r,a,s,c,u,d,h=50;t?"hidden"!==e&&(r=O(T().elem).top,a=O(T().elem).left,s=t.scrollTop,c=s+t.clientHeight,u=t.scrollLeft,d=u+t.clientWidth,i=s,n=u,r+f+h>c?i=r+f+h-t.clientHeight:s>r-h&&(i=r-h),a+f+h>d?n=a+f+h-t.clientWidth:u>a-h&&(n=a-h),m.trackAnimation?P(t,{top:i,left:n},200):(t.scrollTop=i,t.scrollLeft=n)):(r=C(T().elem).top,a=C(T().elem).left,s=(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),c=s+window.innerHeight,u=(window.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0),d=u+window.innerWidth,i=s,n=u,r+f+h>c?i=r+f+h-window.innerHeight:s>r-h&&(i=r-h),a+f+h>d?n=a+f+h-window.innerWidth:u>a-h&&(n=a-h),m.trackAnimation?P(document.body,{top:i,left:n},200):window.scrollTo(n,i))}},C=function(e){for(var t=0,n=0;e;)t+=parseInt(e.offsetTop,10),n+=parseInt(e.offsetLeft,10),e=e.offsetParent;return{top:t,left:n}},O=function(e){var t,n={top:parseInt(e.offsetTop,10),left:parseInt(e.offsetLeft,10)},i={top:parseInt(e.parentElement.offsetTop,10),left:parseInt(e.parentElement.offsetLeft,10)},r=window.getComputedStyle(e.parentElement).getPropertyValue("position");return t="relative"===r||"absolute"===r?n:{top:n.top-i.top,left:n.left-i.left}},P=function(e,t,i){var r=e.scrollTop,o=e.scrollLeft,l=t.top-r,a=t.left-o,s=0,c=20,u=function(){s+=c;var t=n.Easing.InOutQuad(s,r,l,i),f=n.Easing.InOutQuad(s,o,a,i);e.scrollTop=t,e.scrollLeft=f,i>s&&setTimeout(u,c)};u()},j=function(e){var t=parseInt(e.target.getAttribute("data-id"),10);if(t||(t=parseInt(e.target.parentElement.getAttribute("data-id"),10)),t){var n=d;A(t),e.preventDefault(),m.trackActive&&_(),m.click&&m.click(T()),m.move&&n!==t&&m.move(T()),m.select&&m.select(T())}},q=function(e){if(o.length&&m.keyEventsEnabled){var t=e.which||e.keycode;13===t&&(e.preventDefault(),m.enter&&m.enter(T()),m.select&&m.select(T()))}},x=function(e){if(o.length&&m.keyEventsEnabled){var t=e.which||e.keycode,n=!0;switch(t){case 38:W();break;case 40:M();break;case 37:B();break;case 39:K();break;default:n=!1}n&&(e.preventDefault(),m.trackActive&&_(),m.move&&m.move(T()))}},K=function(){var e;e=d?0===d%s?d-s+1:d===o.length?d-c+1:d+1:1,A(e)},B=function(){var e;d?0===(d-1)%s?(e=d+s-1,e>o.length&&(e=o.length)):e=d-1:e=1,A(e)},M=function(){var e;e=d?d>o.length-c?d-a*s:d+s>o.length?d-(a-1)*s:d+s:1,A(e)},W=function(){var e;d?s>=d?(e=d+a*s,e>o.length&&(e-=s)):e=d-s:e=1,A(e)};return this.resize=function(){return I(),p},this.reload=function(e){return e&&(o=e),v=!1,w(),p},this.empty=function(){return this.reload([]),p},this.add=function(e){return o.push(e),s=0,k(),E(o.length-1),1===o.length&&A(1),p},this.remove=function(e){e=parseInt(e,10);for(var t=0;o.length>t;t++)t===e-1&&o.splice(t,1);return w(),p},this.select=function(e){return e=parseInt(e,10),o.length>=e&&(A(e),m.trackActive&&_(),m.move&&m.move(T()),m.select&&m.select(T())),p},this.moveTo=function(e){return e=parseInt(e,10),o.length>=e&&(A(e),m.trackActive&&_(),m.move&&m.move(T())),p},this.__defineGetter__("active",function(){return T()}),this.__defineGetter__("data",function(){return o}),this.__defineGetter__("count",function(){return o.length}),this.__defineGetter__("options",function(){return m}),g(),this}}function t(e){"use strict";var t=e.Elasto,n=t.Easing=function(){return this};n.InOutQuad=function(e,t,n,i){return e/=i/2,1>e?n/2*e*e+t:(e--,-n/2*(e*(e-2)-1)+t)}}"undefined"==typeof DEBUG&&(DEBUG=!0);var n=Function;new n("return this")();var i=function(n){return e(n),t(n),n.Elasto};"function"==typeof define&&define.amd?define(function(){return i({})}):i(this)})(this);